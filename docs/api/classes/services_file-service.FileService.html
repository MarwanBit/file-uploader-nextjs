<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>FileService | File Uploader Next.js - API Documentation - v0.1.0</title><meta name="description" content="Documentation for File Uploader Next.js - API Documentation"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">File Uploader Next.js - API Documentation - v0.1.0</a><div id="tsd-toolbar-links"><a href="https://github.com/marwanbit/file-uploader-nextjs">GitHub</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="../modules/services_file-service.html">services/file-service</a></li><li><a href="" aria-current="page">FileService</a></li></ul><h1>Class FileService</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>Service class for managing file operations including S3 storage and database persistence.</p>
</div><div class="tsd-comment tsd-typography"><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks">Remarks<a href="#remarks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This service provides a centralized interface for all file-related operations, including:</p>
<ul>
<li>Generating presigned URLs for secure file access</li>
<li>Deleting files from both S3 and the database</li>
<li>Creating shareable file links with expiration times</li>
<li>Managing file permissions and folder hierarchies</li>
</ul>
<p>All methods in this service are static and handle their own error management.</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example">Example<a href="#example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-0">// Get a presigned URL for a file</span><br/><span class="hl-1">const</span><span class="hl-2"> { </span><span class="hl-3">url</span><span class="hl-2"> } = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">getFileUrl</span><span class="hl-2">(</span><span class="hl-6">&#39;file-123&#39;</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Share a file for 24 hours</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">shareInfo</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">shareFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-123&#39;</span><span class="hl-2">, </span><span class="hl-10">24</span><span class="hl-2">);</span><br/><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">`File expires at: </span><span class="hl-1">${</span><span class="hl-7">shareInfo</span><span class="hl-11">.</span><span class="hl-7">expires_at</span><span class="hl-1">}</span><span class="hl-6">`</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Delete a file</span><br/><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">deleteFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-123&#39;</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see">See<a href="#see" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html">AWS S3 Presigned URLs</a></p>
</div></div></section><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L35">src/services/file-service.ts:35</a></li></ul></aside><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><details class="tsd-index-content tsd-accordion" open><summary class="tsd-accordion-summary tsd-index-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h5 class="tsd-index-heading uppercase">Index</h5></summary><div class="tsd-accordion-details"><section class="tsd-index-section"><h3 class="tsd-index-heading">Constructors</h3><div class="tsd-index-list"><a href="#constructor" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Methods</h3><div class="tsd-index-list"><a href="#getfileurl" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File<wbr/>Url</span></a>
<a href="#deletefile" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>delete<wbr/>File</span></a>
<a href="#sharefile" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>share<wbr/>File</span></a>
<a href="#getfile" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File</span></a>
<a href="#fileinrootfolder" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>file<wbr/>In<wbr/>Root<wbr/>Folder</span></a>
<a href="#getfilefromsharetoken" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File<wbr/>From<wbr/>Share<wbr/>Token</span></a>
</div></section></div></details></section></section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Constructors</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="constructor"><span>constructor</span><a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="constructorfileservice"><span class="tsd-signature-keyword">new</span> <span class="tsd-kind-constructor-signature">FileService</span><span class="tsd-signature-symbol">()</span><span class="tsd-signature-symbol">:</span> <a href="" class="tsd-signature-type tsd-kind-class">FileService</a><a href="#constructorfileservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><h4 class="tsd-returns-title">Returns <a href="" class="tsd-signature-type tsd-kind-class">FileService</a></h4></div></li></ul></section></section></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Methods</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="getfileurl"><code class="tsd-tag">Static</code><span>get<wbr/>File<wbr/>Url</span><a href="#getfileurl" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="getfileurl-1"><span class="tsd-kind-call-signature">getFileUrl</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">fileId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span><a href="#getfileurl-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Generates a temporary presigned URL for accessing a file stored in S3.</p>
<p>This method retrieves file metadata from the database and creates a presigned URL
that allows temporary access to the file without requiring AWS credentials.
The URL expires after 4000 seconds (~67 minutes) by default.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">fileId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the file in the database</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to an object containing the presigned URL</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws">Throws<a href="#throws" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if:</p>
<ul>
<li>The file is not found in the database</li>
<li>The file doesn't have an associated S3 key</li>
<li>There's a failure communicating with S3 or the database</li>
</ul>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-1">Example<a href="#example-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">result</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">getFileUrl</span><span class="hl-2">(</span><span class="hl-6">&#39;abc-123-def&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;Download URL:&#39;</span><span class="hl-2">, </span><span class="hl-7">result</span><span class="hl-2">.</span><span class="hl-7">url</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-0">// User can now access the file at this URL for ~67 minutes</span><br/><span class="hl-2">} </span><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-7">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">error</span><span class="hl-2">(</span><span class="hl-6">&#39;Failed to get file URL:&#39;</span><span class="hl-2">, </span><span class="hl-7">error</span><span class="hl-2">);</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks-1">Remarks<a href="#remarks-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>The presigned URL is temporary and will expire. Clients should not cache these URLs
for extended periods. The expiration time is currently hardcoded to 4000 seconds but
could be made configurable in future versions.</p>
</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-1">See<a href="#see-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><a href="#deletefile" class="tsd-kind-method">deleteFile</a> for removing files</li>
<li><a href="#sharefile" class="tsd-kind-method">shareFile</a> for creating shareable links with custom expiration times</li>
</ul>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L78">src/services/file-service.ts:78</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="deletefile"><code class="tsd-tag">Static</code><span>delete<wbr/>File</span><a href="#deletefile" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="deletefile-1"><span class="tsd-kind-call-signature">deleteFile</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">fileId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">message</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span><a href="#deletefile-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Permanently deletes a file from both S3 storage and the database.</p>
<p>This operation is irreversible. The method first retrieves the file metadata,
removes the object from S3, and then deletes the database record.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">fileId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the file to delete</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">message</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to an object containing a success message</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-1">Throws<a href="#throws-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if:</p>
<ul>
<li>The file is not found in the database</li>
<li>The S3 deletion fails</li>
<li>The database deletion fails</li>
</ul>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-2">Example<a href="#example-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-0">// Delete a file</span><br/><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">result</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">deleteFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-456&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-7">result</span><span class="hl-2">.</span><span class="hl-7">message</span><span class="hl-2">); </span><span class="hl-0">// &quot;deletion successful!&quot;</span><br/><span class="hl-2">} </span><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-7">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">error</span><span class="hl-2">(</span><span class="hl-6">&#39;Failed to delete file:&#39;</span><span class="hl-2">, </span><span class="hl-7">error</span><span class="hl-2">);</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks-2">Remarks<a href="#remarks-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This is a destructive operation. Consider implementing a soft delete mechanism
or moving files to a &quot;trash&quot; folder before permanent deletion in production systems.</p>
</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-2">See<a href="#see-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><a href="#getfile" class="tsd-kind-method">getFile</a> for retrieving file metadata before deletion</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L150">src/services/file-service.ts:150</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="sharefile"><code class="tsd-tag">Static</code><span>share<wbr/>File</span><a href="#sharefile" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="sharefile-1"><span class="tsd-kind-call-signature">shareFile</span><span class="tsd-signature-symbol">(</span><br/>    <span class="tsd-kind-parameter">fileId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span><br/>    <span class="tsd-kind-parameter">hours</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">expires_at</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Date</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">message</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span><a href="#sharefile-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Beta</code><div class="tsd-comment tsd-typography"><p>Creates a shareable presigned URL for a file with a custom expiration time.</p>
<p>This method generates a temporary URL that can be shared with others to provide
time-limited access to a file. The file's expiration time in the database is also
updated to match or extend the current expiration.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">fileId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the file to share</p>
</div></li><li><span><span class="tsd-kind-parameter">hours</span>: <span class="tsd-signature-type">number</span></span><div class="tsd-comment tsd-typography"><p>The number of hours until the share link expires (converted to seconds internally)</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">expires_at</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Date</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">message</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to an object containing:</p>
<ul>
<li><code>url</code>: The presigned URL for accessing the file</li>
<li><code>expires_at</code>: The Date when the share link expires</li>
<li><code>message</code>: A success message</li>
</ul>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-2">Throws<a href="#throws-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if:</p>
<ul>
<li>The file is not found in the database</li>
<li>The file doesn't have an S3 key</li>
<li>The presigned URL generation fails</li>
<li>The database update fails</li>
</ul>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-3">Example<a href="#example-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-0">// Share a file for 48 hours</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">shareInfo</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">shareFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-789&#39;</span><span class="hl-2">, </span><span class="hl-10">48</span><span class="hl-2">);</span><br/><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">`Share this link: </span><span class="hl-1">${</span><span class="hl-7">shareInfo</span><span class="hl-11">.</span><span class="hl-7">url</span><span class="hl-1">}</span><span class="hl-6">`</span><span class="hl-2">);</span><br/><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">`Link expires: </span><span class="hl-1">${</span><span class="hl-7">shareInfo</span><span class="hl-11">.</span><span class="hl-7">expires_at</span><span class="hl-11">.</span><span class="hl-5">toLocaleString</span><span class="hl-11">()</span><span class="hl-1">}</span><span class="hl-6">`</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Share for 1 hour</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">quickShare</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">shareFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-789&#39;</span><span class="hl-2">, </span><span class="hl-10">1</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks-3">Remarks<a href="#remarks-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>The method intelligently handles expiration times by taking the maximum of:</p>
<ol>
<li>The new expiration time (now + hours)</li>
<li>The existing expiration time (if any)</li>
</ol>
<p>This ensures that sharing a file multiple times extends the expiration rather
than potentially shortening it.</p>
</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-3">See<a href="#see-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><a href="#getfileurl" class="tsd-kind-method">getFileUrl</a> for generating URLs without updating expiration</li>
<li><a href="#getfilefromsharetoken" class="tsd-kind-method">getFileFromShareToken</a> for accessing shared files via share tokens</li>
</ul>
<p>This method's expiration extension behavior may change in future versions to support
more granular control over share link lifecycles.</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L231">src/services/file-service.ts:231</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="getfile"><code class="tsd-tag">Static</code><span>get<wbr/>File</span><a href="#getfile" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="getfile-1"><span class="tsd-kind-call-signature">getFile</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">fileId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../types/types_types.File.html" class="tsd-signature-type tsd-kind-type-alias">File</a> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">null</span><span class="tsd-signature-symbol">&gt;</span><a href="#getfile-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Retrieves file metadata from the database by its unique identifier.</p>
<p>This is a simple getter method that fetches a file record without any
additional processing or URL generation.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">fileId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the file to retrieve</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="../types/types_types.File.html" class="tsd-signature-type tsd-kind-type-alias">File</a> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">null</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to the File object if found, or null if not found</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-3">Throws<a href="#throws-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if there's a database communication failure</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-4">Example<a href="#example-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">file</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">getFile</span><span class="hl-2">(</span><span class="hl-6">&#39;file-abc-123&#39;</span><span class="hl-2">);</span><br/><span class="hl-4">if</span><span class="hl-2"> (</span><span class="hl-7">file</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;File name:&#39;</span><span class="hl-2">, </span><span class="hl-7">file</span><span class="hl-2">.</span><span class="hl-7">name</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;File size:&#39;</span><span class="hl-2">, </span><span class="hl-7">file</span><span class="hl-2">.</span><span class="hl-7">size</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;Created at:&#39;</span><span class="hl-2">, </span><span class="hl-7">file</span><span class="hl-2">.</span><span class="hl-7">created_at</span><span class="hl-2">);</span><br/><span class="hl-2">} </span><span class="hl-4">else</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;File not found&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-4">See<a href="#see-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><a href="../types/types_types.File.html" class="tsd-kind-type-alias">File</a> for the complete file type definition</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L305">src/services/file-service.ts:305</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="fileinrootfolder"><code class="tsd-tag">Static</code><span>file<wbr/>In<wbr/>Root<wbr/>Folder</span><a href="#fileinrootfolder" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="fileinrootfolder-1"><span class="tsd-kind-call-signature">fileInRootFolder</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">rootFolderId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span> <span class="tsd-kind-parameter">fileId</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span><a href="#fileinrootfolder-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Internal</code><div class="tsd-comment tsd-typography"><p>Determines whether a file exists within a specific folder hierarchy.</p>
<p>This method traverses the folder tree upward from the file's parent folder
to check if the specified root folder is an ancestor. This is useful for
permission checks and validating file access within shared folders.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">rootFolderId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the potential root/ancestor folder</p>
</div></li><li><span><span class="tsd-kind-parameter">fileId</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The unique identifier of the file to check</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to:</p>
<ul>
<li><code>true</code> if the file exists within the folder hierarchy rooted at rootFolderId</li>
<li><code>false</code> if the file is not within that hierarchy, or if either the file or folder doesn't exist</li>
</ul>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-4">Throws<a href="#throws-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if there's a database communication failure during traversal</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-5">Example<a href="#example-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-0">// Check if a file belongs to a shared folder</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">isInFolder</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">fileInRootFolder</span><span class="hl-2">(</span><br/><span class="hl-2">  </span><span class="hl-6">&#39;shared-folder-123&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">&#39;file-456&#39;</span><br/><span class="hl-2">);</span><br/><br/><span class="hl-4">if</span><span class="hl-2"> (</span><span class="hl-7">isInFolder</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;User has access to this file via the shared folder&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">} </span><span class="hl-4">else</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;File is not in the shared folder hierarchy&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks-4">Remarks<a href="#remarks-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>The algorithm uses an iterative approach to traverse the folder tree:</p>
<ol>
<li>Start with the file's immediate parent folder</li>
<li>Check if it matches the root folder ID</li>
<li>If not, move to the parent's parent folder</li>
<li>Repeat until a match is found or the tree root is reached</li>
</ol>
<p>This method is commonly used in conjunction with share token validation
to ensure users can only access files within folders they have permission to view.</p>
</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-5">See<a href="#see-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><a href="#getfilefromsharetoken" class="tsd-kind-method">getFileFromShareToken</a> which uses this method for permission validation</li>
<li><a href="../types/types_types.Folder.html" class="tsd-kind-type-alias">Folder</a> for the folder type definition</li>
</ul>
<p>The current implementation makes multiple database queries during traversal.
Consider optimizing with a recursive CTE or materialized path approach for
better performance with deep folder hierarchies.</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L369">src/services/file-service.ts:369</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="getfilefromsharetoken"><code class="tsd-tag">Static</code><span>get<wbr/>File<wbr/>From<wbr/>Share<wbr/>Token</span><a href="#getfilefromsharetoken" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="getfilefromsharetoken-1"><span class="tsd-kind-call-signature">getFileFromShareToken</span><span class="tsd-signature-symbol">(</span><br/>    <span class="tsd-kind-parameter">root_folder</span><span class="tsd-signature-symbol">:</span> <a href="../types/types_types.Folder.html" class="tsd-signature-type tsd-kind-type-alias">Folder</a><span class="tsd-signature-symbol">,</span><br/>    <span class="tsd-kind-parameter">file</span><span class="tsd-signature-symbol">:</span> <a href="../types/types_types.File.html" class="tsd-signature-type tsd-kind-type-alias">File</a><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">expires_at</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Date</span> <span class="tsd-signature-symbol">}</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">null</span><span class="tsd-signature-symbol">&gt;</span><a href="#getfilefromsharetoken-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Generates a presigned URL for a file accessed via a share token.</p>
<p>This method validates that the requested file belongs to the shared folder hierarchy
and creates a presigned URL with an expiration time matching the folder's share token
expiration. The URL expiration is capped at 168 hours (7 days) to comply with AWS
S3 presigned URL limitations.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">root_folder</span>: <a href="../types/types_types.Folder.html" class="tsd-signature-type tsd-kind-type-alias">Folder</a></span><div class="tsd-comment tsd-typography"><p>The shared folder object containing the share token expiration</p>
</div></li><li><span><span class="tsd-kind-parameter">file</span>: <a href="../types/types_types.File.html" class="tsd-signature-type tsd-kind-type-alias">File</a></span><div class="tsd-comment tsd-typography"><p>The file object to generate a URL for</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">url</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">expires_at</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Date</span> <span class="tsd-signature-symbol">}</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">null</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to:</p>
<ul>
<li>An object with <code>url</code> and <code>expires_at</code> if the file is in the folder hierarchy</li>
<li><code>null</code> if the file is not within the shared folder's hierarchy</li>
</ul>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-5">Throws<a href="#throws-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Error
Throws an error if:</p>
<ul>
<li>The folder hierarchy traversal fails</li>
<li>The presigned URL generation fails</li>
<li>There's a database communication error</li>
</ul>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-6">Example<a href="#example-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-0">// Assuming we have a shared folder and file from a share token</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">sharedFolder</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">getSharedFolder</span><span class="hl-2">(</span><span class="hl-7">shareToken</span><span class="hl-2">);</span><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">requestedFile</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">getFile</span><span class="hl-2">(</span><span class="hl-7">fileId</span><span class="hl-2">);</span><br/><br/><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-3">result</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-7">FileService</span><span class="hl-2">.</span><span class="hl-5">getFileFromShareToken</span><span class="hl-2">(</span><br/><span class="hl-2">  </span><span class="hl-7">sharedFolder</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">requestedFile</span><br/><span class="hl-2">);</span><br/><br/><span class="hl-4">if</span><span class="hl-2"> (</span><span class="hl-7">result</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;Access URL:&#39;</span><span class="hl-2">, </span><span class="hl-7">result</span><span class="hl-2">.</span><span class="hl-7">url</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;Expires at:&#39;</span><span class="hl-2">, </span><span class="hl-7">result</span><span class="hl-2">.</span><span class="hl-7">expires_at</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-0">// Redirect user to the presigned URL</span><br/><span class="hl-2">} </span><span class="hl-4">else</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-7">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">&#39;File not accessible via this share token&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks-5">Remarks<a href="#remarks-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This method implements several important behaviors:</p>
<p><strong>Expiration Time Calculation:</strong></p>
<ul>
<li>If the folder has an expiration, calculates remaining time in seconds</li>
<li>Defaults to 1 hour if expiration has passed or is not set</li>
<li>Converts to hours (rounded up) and caps at 168 hours (AWS S3 limit)</li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li>Validates file belongs to the shared folder hierarchy before generating URL</li>
<li>Respects the folder's share token expiration</li>
<li>Returns null if validation fails (preventing unauthorized access)</li>
</ul>
<p><strong>Performance:</strong></p>
<ul>
<li>Delegates hierarchy checking to <a href="#fileinrootfolder" class="tsd-kind-method">fileInRootFolder</a></li>
<li>Delegates URL generation to <a href="#sharefile" class="tsd-kind-method">shareFile</a></li>
</ul>
</div><div class="tsd-tag-see"><h4 class="tsd-anchor-link" id="see-6">See<a href="#see-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><a href="#fileinrootfolder" class="tsd-kind-method">fileInRootFolder</a> for the hierarchy validation logic</li>
<li><a href="#sharefile" class="tsd-kind-method">shareFile</a> for the presigned URL generation logic</li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html">AWS S3 Presigned URL Limits</a></li>
</ul>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/MarwanBit/file-uploader-nextjs/blob/ebf65e9978cac76d70d9b3f8dca33f8c4c4a983b/src/services/file-service.ts#L472">src/services/file-service.ts:472</a></li></ul></aside></div></li></ul></section></section></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Constructors</summary><div><a href="#constructor"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Methods</summary><div><a href="#getfileurl"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File<wbr/>Url</span></a><a href="#deletefile"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>delete<wbr/>File</span></a><a href="#sharefile"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>share<wbr/>File</span></a><a href="#getfile"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File</span></a><a href="#fileinrootfolder"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>file<wbr/>In<wbr/>Root<wbr/>Folder</span></a><a href="#getfilefromsharetoken"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>File<wbr/>From<wbr/>Share<wbr/>Token</span></a></div></details></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/marwanbit/file-uploader-nextjs" class="tsd-nav-link">GitHub</a></nav><nav class="tsd-navigation"><a href="../modules.html">File Uploader Next.js - API Documentation - v0.1.0</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
